<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pool (tiny_httpd.Tiny_httpd_core.Pool)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">tiny_httpd</a> &#x00BB; <a href="../index.html">Tiny_httpd_core</a> &#x00BB; Pool</nav><header class="odoc-preamble"><h1>Module <code><span>Tiny_httpd_core.Pool</span></code></h1><p>Resource pool.</p><p>This pool is used for buffers. It can be used for other resources but do note that it assumes resources are still reasonably cheap to produce and discard, and will never block waiting for a resource — it's not a good pool for DB connections.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.14.</li></ul></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>Pool of values of type <code>'a</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><span class="optlabel">?clear</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">mk_item</span>:<span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?max_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Create a new pool.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">mk_item</span> <p>produce a new item in case the pool is empty</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">max_size</span> <p>maximum number of item in the pool before we start dropping resources on the floor. This controls resource consumption.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">clear</span> <p>a function called on items before recycling them.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_resource"><a href="#val-with_resource" class="anchor"></a><code><span><span class="keyword">val</span> with_resource : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>with_resource pool f</code> runs <code>f x</code> with <code>x</code> a resource; when <code>f</code> fails or returns, <code>x</code> is returned to the pool for future reuse.</p></div></div></div></body></html>
